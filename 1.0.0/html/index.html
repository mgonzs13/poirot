<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>POIROT (PrOfIling RObotics Tool): POIROT (PrOfIling RObotics Tool)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">POIROT (PrOfIling RObotics Tool)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">POIROT (PrOfIling RObotics Tool) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p align="center"></p>
<p><img src="./docs/logo.png" alt="" width="50%" class="inline"/> </p>
<hr  />
<p><b>POIROT</b> is a comprehensive profiling and monitoring framework for ROS 2 applications that provides detailed insights into function performance, resource consumption, energy usage and CO2 emissions. With its htop-like terminal interface, real-time data visualization and CSV recording capabilities, POIROT enables developers to optimize their robotic systems for performance and sustainability, acting as a keen investigator of code inefficiencies.</p>
<hr  />
<div align="center"></div><div align="center"><a href="https://opensource.org/license/apache-2"><img src="https://img.shields.io/badge/GitHub-Apache-2" alt="License: Apache-2" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot/releases"><img src="https://img.shields.io/github/release/mgonzs13/poirot.svg" alt="GitHub release" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot?branch=main"><img src="https://img.shields.io/github/languages/code-size/mgonzs13/poirot.svg?branch=main" alt="Code Size" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot/commits/main"><img src="https://img.shields.io/github/last-commit/mgonzs13/poirot.svg" alt="Last Commit" style="pointer-events: none;" class="inline"/></a></div><div align="center"><a href="https://github.com/mgonzs13/poirot/issues"><img src="https://img.shields.io/github/issues/mgonzs13/poirot" alt="GitHub issues" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot/pulls"><img src="https://img.shields.io/github/issues-pr/mgonzs13/poirot" alt="GitHub pull requests" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot/graphs/contributors"><img src="https://img.shields.io/github/contributors/mgonzs13/poirot.svg" alt="Contributors" style="pointer-events: none;" class="inline"/></a></div><div align="center"><a href="https://github.com/mgonzs13/poirot/actions/workflows/python-formatter.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/python-formatter.yml/badge.svg?branch=main" alt="Python Formatter Check" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/mgonzs13/poirot/actions/workflows/cpp-formatter.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/cpp-formatter.yml/badge.svg?branch=main" alt="C++ Formatter Check" style="pointer-events: none;" class="inline"/></a></div><div align="center"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">ROS 2 Distro   </th><th class="markdownTableHeadCenter">Build and Test    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Foxy</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/foxy-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/foxy-build-test.yml/badge.svg?branch=main" alt="Foxy Build" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Galatic</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/galactic-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/galactic-build-test.yml/badge.svg?branch=main" alt="Galactic Build" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Humble</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/humble-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/humble-build-test.yml/badge.svg?branch=main" alt="Humble Build and Test" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Iron</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/iron-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/iron-build-test.yml/badge.svg?branch=main" alt="Iron Build" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Jazzy</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/jazzy-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/jazzy-build-test.yml/badge.svg?branch=main" alt="Jazzy Build" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><b>Kilted</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/kilted-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/kilted-build-test.yml/badge.svg?branch=main" alt="Kilted Build" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Rolling</b>   </td><td class="markdownTableBodyCenter"><a href="https://github.com/mgonzs13/poirot/actions/workflows/rolling-build-test.yml?branch=main"><img src="https://github.com/mgonzs13/poirot/actions/workflows/rolling-build-test.yml/badge.svg?branch=main" alt="Rolling Build" style="pointer-events: none;" class="inline"/></a>   </td></tr>
</table>
</div><div align="center"></div><h1><a class="anchor" id="autotoc_md3"></a>
Table of Contents</h1>
<ul>
<li>Features</li>
<li>Installation</li>
<li>Usage</li>
<li>Demos<ul>
<li>Quick Start Demo</li>
<li>Running with TUI</li>
<li>Recording Data to CSV</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Features</h1>
<h2><a class="anchor" id="autotoc_md5"></a>
Core Profiling Library (<code>poirot</code>)</h2>
<ul>
<li><b>Automatic System Configuration</b>: Detects CPU model, RAM, OS, energy measurement capabilities (Intel RAPL, AMD RAPL, hwmon) and downloads CO2 emission factors by country</li>
<li><b>Comprehensive Metrics Collection</b>:<ul>
<li><b>Timing</b>: Wall time and CPU time (user + system) per function</li>
<li><b>Memory</b>: RSS and VSZ memory usage tracking</li>
<li><b>I/O Operations</b>: Read/write bytes monitoring</li>
<li><b>System Metrics</b>: Context switches (voluntary/involuntary), page faults (minor/major)</li>
<li><b>Energy</b>: Real-time energy consumption in Joules (when hardware support available)</li>
<li><b>Sustainability</b>: CO2 emissions estimation in grams based on regional energy mix</li>
</ul>
</li>
<li><b>Low Overhead</b>: Efficient RAII-based profiling with minimal impact on application performance</li>
<li><b>ROS 2 Integration</b>: Publishes profiling data via <code>/poirot/data</code> topic using custom message types</li>
<li><b>Thread-Safe</b>: Concurrent profiling across multiple threads and nodes</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
Terminal User Interface (<code>poirot_tui</code>)</h2>
<ul>
<li><b>htop-like Table View</b>: Real-time display of all profiled functions with sortable columns<ul>
<li>PID, Function Name, Call Count</li>
<li>Wall Time, CPU Time, CPU%, Memory Usage</li>
<li>I/O Read/Write, Context Switches</li>
<li>Energy Consumption, CO2 Emissions</li>
</ul>
</li>
<li><b>Real-time Graphs</b>: Interactive time-series visualization for each metric<ul>
<li>Wall Time, CPU Time, Memory, I/O (Read/Write)</li>
<li>Context Switches, Energy, CO2</li>
<li>Toggle individual functions on/off</li>
<li>Color-coded function traces with legend</li>
</ul>
</li>
<li><b>Mouse &amp; Keyboard Support</b>:<ul>
<li>Click to navigate, sort and select</li>
<li>Keyboard shortcuts for all operations</li>
<li>Scroll wheel navigation</li>
</ul>
</li>
<li><b>Multiple Views</b>: Quick tab switching between table and graph views (9 tabs total)</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
CSV Recorder (<code>poirot_recorder</code>)</h2>
<ul>
<li><b>Persistent Data Storage</b>: Records all profiling data to CSV files for offline analysis</li>
<li><b>Comprehensive Data Export</b>:<ul>
<li>Function statistics (total and last call metrics)</li>
<li>Process information (PID, CPU%, memory, I/O, threads)</li>
<li>System information (OS, CPU model, cores, TDP, country code, CO2 factors)</li>
</ul>
</li>
<li><b>Configurable Output</b>: CSV file path via ROS 2 parameter</li>
<li><b>Thread-Safe Writing</b>: Automatic flushing with proper CSV escaping</li>
<li><b>Progress Logging</b>: Status updates every 100 records</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Demo Applications (<code>poirot_demos</code>)</h2>
<ul>
<li><b>Example Publisher/Subscriber</b>: Demonstrates profiling in typical ROS 2 patterns</li>
<li><b>Timer Functions</b>: Shows profiling of periodic callbacks</li>
<li><b>Realistic Workloads</b>: Simulates CPU-intensive operations and memory allocation</li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
Message Definitions (<code>poirot_msgs</code>)</h2>
<ul>
<li>Custom ROS 2 message types for profiling data:<ul>
<li><code>ProfilingData</code>: Complete profiling snapshot</li>
<li><code>FunctionStats</code>: Aggregated function metrics</li>
<li><code>FunctionCall</code>: Individual call data</li>
<li><code>Data</code>: Detailed metrics (time, memory, I/O, energy, CO2)</li>
<li><code>ProcessInfo</code>: Process-level information</li>
<li><code>SystemInfo</code>: System-level configuration</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Installation</h1>
<div class="fragment"><div class="line">cd ~/ros2_ws/src</div>
<div class="line">git clone https://github.com/mgonzs13/poirot</div>
<div class="line">cd ~/ros2_ws</div>
<div class="line">rosdep install --from-paths src --ignore-src -r -y</div>
<div class="line">colcon build</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11"></a>
Usage</h1>
<ol type="1">
<li><p class="startli"><b>Add dependency in <code>package.xml</code></b>:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">depend</span>&gt;<span class="keyword">poirot</span>&lt;/<span class="keywordtype">depend</span>&gt;</div>
</div><!-- fragment --></li>
<li><p class="startli"><b>Update <code>CMakeLists.txt</code></b>:</p>
<div class="fragment"><div class="line">find_package(poirot REQUIRED)</div>
<div class="line"> </div>
<div class="line">add_executable(your_node src/your_node.cpp)</div>
<div class="line">target_link_libraries(your_node</div>
<div class="line">  poirot::poirot</div>
<div class="line">)</div>
</div><!-- fragment --></li>
<li><p class="startli"><b>Instrument your code</b>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="poirot_8hpp.html">poirot/poirot.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacepoirot.html">poirot</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyNode : <span class="keyword">public</span> rclcpp::Node {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  MyNode() : Node(<span class="stringliteral">&quot;my_node&quot;</span>) {</div>
<div class="line">    <span class="comment">// Create timer, subscribers, etc.</span></div>
<div class="line">    timer_ = create_wall_timer(</div>
<div class="line">      std::chrono::seconds(1),</div>
<div class="line">      std::bind(&amp;MyNode::timer_callback, <span class="keyword">this</span>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span> timer_callback() {</div>
<div class="line">    <a class="code hl_define" href="poirot_8hpp.html#aea5bb1ebe0e3e32e5927e899daa2011d">PROFILE_FUNCTION</a>();  <span class="comment">// Automatically profiles this function</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Your function logic here...</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  rclcpp::TimerBase::SharedPtr timer_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">  rclcpp::init(argc, argv);</div>
<div class="line">  <span class="keyword">auto</span> node = std::make_shared&lt;MyNode&gt;();</div>
<div class="line">  rclcpp::spin(node);</div>
<div class="line">  rclcpp::shutdown();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="amain_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> main.cpp:32</div></div>
<div class="ttc" id="anamespacepoirot_html"><div class="ttname"><a href="namespacepoirot.html">poirot</a></div><div class="ttdef"><b>Definition</b> poirot.hpp:39</div></div>
<div class="ttc" id="apoirot_8hpp_html"><div class="ttname"><a href="poirot_8hpp.html">poirot.hpp</a></div></div>
<div class="ttc" id="apoirot_8hpp_html_aea5bb1ebe0e3e32e5927e899daa2011d"><div class="ttname"><a href="poirot_8hpp.html#aea5bb1ebe0e3e32e5927e899daa2011d">PROFILE_FUNCTION</a></div><div class="ttdeci">#define PROFILE_FUNCTION()</div><div class="ttdef"><b>Definition</b> poirot.hpp:381</div></div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md12"></a>
Demos</h1>
<h2><a class="anchor" id="autotoc_md13"></a>
Quick Start Demo</h2>
<p>The fastest way to see POIROT in action is to run the demo application with the TUI monitor:</p>
<p><b>Terminal 1</b> - Run the demo node with profiling:</p>
<div class="fragment"><div class="line">ros2 run poirot_demos demo_node</div>
</div><!-- fragment --><p><b>Terminal 2</b> - Run the TUI monitor:</p>
<div class="fragment"><div class="line">ros2 run poirot_tui poirot_tui</div>
</div><!-- fragment --><p>You should see a live table displaying profiling metrics for the demo node's timer and subscription callbacks, including wall time, CPU usage, memory consumption, energy and CO2 emissions.</p>
<p><a href="https://github.com/user-attachments/assets/d55aa278-0150-41a6-b064-2ef51294a8c5">https://github.com/user-attachments/assets/d55aa278-0150-41a6-b064-2ef51294a8c5</a></p>
<h2><a class="anchor" id="autotoc_md14"></a>
Running with TUI</h2>
<p>The TUI provides multiple views and interactive controls:</p>
<h3><a class="anchor" id="autotoc_md15"></a>
TUI Controls</h3>
<p><b>General Navigation</b>:</p>
<ul>
<li><code>Q</code> / <code>ESC</code> - Quit</li>
<li><code>Tab</code> / <code>→</code> - Next tab</li>
<li><code>Shift+Tab</code> / <code>←</code> - Previous tab</li>
<li><code>1-9</code> - Jump to specific tab</li>
<li><code>C</code> - Clear all data</li>
</ul>
<p><b>Table View</b>:</p>
<ul>
<li><code>↑</code> / <code>K</code> / <code>↓</code> / <code>J</code> - Navigate rows</li>
<li><code>PgUp</code> / <code>PgDn</code> - Page up/down</li>
<li><code>Home</code> / <code>G</code> - First row</li>
<li><code>End</code> / <code>Shift+G</code> - Last row</li>
<li><code>S</code> - Cycle sort column</li>
<li><code>R</code> / <code>O</code> - Toggle sort order</li>
</ul>
<p><b>Graph Views</b>:</p>
<ul>
<li><code>↑</code> / <code>K</code> / <code>↓</code> / <code>J</code> - Navigate function list</li>
<li><code>Space</code> / <code>Enter</code> - Toggle selected function in graph</li>
<li><code>A</code> - Enable all functions</li>
<li><code>N</code> - Disable all functions</li>
</ul>
<h3><a class="anchor" id="autotoc_md16"></a>
Available Tabs</h3>
<ol type="1">
<li><b>Table</b> - Main table view with all profiling data</li>
<li><b>Wall</b> - Wall time graph over time</li>
<li><b>CPU</b> - CPU time graph over time</li>
<li><b>Mem</b> - Memory usage graph over time</li>
<li><b>IO-R</b> - I/O read bytes graph over time</li>
<li><b>IO-W</b> - I/O write bytes graph over time</li>
<li><b>Ctx</b> - Context switches graph over time</li>
<li><b>Enrg</b> - Energy consumption graph over time</li>
<li><b>CO2</b> - CO2 emissions graph over time</li>
</ol>
<h2><a class="anchor" id="autotoc_md17"></a>
Recording Data to CSV</h2>
<p>To record profiling data for offline analysis:</p>
<p><b>Terminal 1</b> - Run your ROS 2 application:</p>
<div class="fragment"><div class="line">ros2 run poirot_demos demo_node</div>
</div><!-- fragment --><p><b>Terminal 2</b> - Start the recorder:</p>
<div class="fragment"><div class="line">ros2 run poirot_recorder poirot_recorder_node --ros-args -p csv_file_path:=/tmp/profiling_data.csv</div>
</div><!-- fragment --><p>The CSV file will contain comprehensive profiling data including timestamps, function names, call counts, timing metrics, memory usage, I/O statistics, energy consumption, CO2 emissions and system information. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
